WT_DECLARE_WT_MEMBER(1,JavaScriptConstructor,"WLeafletMap",(function(e,t,n,o,i,a){t.wtObj&&t.wtObj.map.remove();t.wtObj=this;const p=this;this.map=null;const s={};let d=a,l=[o,i];this.addTileLayer=function(e,t){const n=JSON.parse(t);L.tileLayer(e,n).addTo(p.map)};this.zoom=function(e){d=e;p.map.setZoom(e)};this.panTo=function(e,t){l=[e,t];p.map.panTo([e,t])};this.addPolyline=function(e,t){const n=JSON.parse(t);L.polyline(e,n).addTo(p.map)};this.addCircle=function(e,t){const n=JSON.parse(t);L.circle(e,n).addTo(p.map)};this.addOverlayItem=function(e,n,o){o.contentHolder=document.createElement("div");o.contentHolder.style.cssText="visibility: hidden;";t.appendChild(o.contentHolder);o.item_id=e;o.parent_id=n;s[e]=o;p.toggleOverlayItem(e,!0)};this.addMapItem=function(e,t,n){n.addTo(p.map);s[e]=n};this.removeMapItem=function(e){const t=s[e];if(t){const n=t.parent_id;if((n||0===n)&&-1!==n){const t=s[n];t&&t.getPopup().item_id===e&&t.unbindPopup()}t.contentHolder&&t.contentHolder.remove();p.map.removeLayer(t);delete s[e]}};this.moveMapItem=function(e,t){const n=s[e];n&&n.setLatLng(t)};this.setOverlayItemContent=function(e,t,n){const o=s[e];if(o){o.contentId=n;o.contentHolder.innerHTML=t;if(o.isOpen()){const e=o.contentHolder.firstChild;o.setContent(o.contentHolder.removeChild(e))}p.delayedJS()}};this.moveOverlayItemToFront=function(e){const t=s[e];t&&t.bringToFront()};this.moveOverlayItemToBack=function(e){const t=s[e];t&&t.bringToBack()};this.toggleOverlayItem=function(e,t){const n=s[e];if(n)if(t&&!n.isOpen()){const e=n.parent_id;if(-1===e)n.openOn(this.map);else{const t=s[e];t&&t.bindPopup(n).openPopup()}}else!t&&n.isOpen()&&n.close()};this.wtResize=function(){p.map.invalidateSize()};t.wtEncodeValue=function(){const e=p.map.getCenter(),t=[e.lat,e.lng],n=p.map.getZoom();return JSON.stringify({position:t,zoom:n})};this.init=function(n,o,i){const a=JSON.parse(n);a.center=o;a.zoom=i;p.map=L.map(t,a);const s=parseInt(function(){let e=t.parentNode;for(;e;){if(e.wtPopup)return e.style.zIndex;e=e.parentNode}return 0}(),10);if(s>0){p.map.getPane("tilePane").style.zIndex=s+200;p.map.getPane("overlayPane").style.zIndex=s+400;p.map.getPane("shadowPane").style.zIndex=s+500;p.map.getPane("markerPane").style.zIndex=s+600;p.map.getPane("tooltipPane").style.zIndex=s+650;p.map.getPane("popupPane").style.zIndex=s+700}p.map.on("zoomend",(function(){const n=p.map.getZoom();if(n!==d){e.emit(t,"zoomLevelChanged",n);d=n}}));p.map.on("moveend",(function(){const n=p.map.getCenter();if(n.lat!==l[0]||n.lng!==l[1]){e.emit(t,"panChanged",n.lat,n.lng);l=[n.lat,n.lng]}}));p.map.on("popupclose",(function(n){const o=n.popup.getContent();o.remove();n.popup.contentHolder.appendChild(o);e.emit(t,"overlayItemToggled",n.popup.item_id,!1)}));p.map.on("popupopen",(function(n){const o=n.popup.contentHolder.firstChild;o&&n.popup.setContent(n.popup.contentHolder.removeChild(o));e.emit(t,"overlayItemToggled",n.popup.item_id,!0)}))};this.init(n,[o,i],a)}));